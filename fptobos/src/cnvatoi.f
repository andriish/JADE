      SUBROUTINE CNVATOI(INN)
*
*  Convert the 4-byte ASCII word INN to EBCDIC 
*
*         Algorithm adapted from subr. CNVR12 in FPACK  (V. Blobel)
*
*    J.Olsson    16.12.2005
*
      INTEGER INN
      INTEGER ATOE(0:255)
*
      DATA (ATOE(I),I=0,255) /
     +   0, 64, 64, 64, 64,  9, 64, 64, 64, 64, 64, 64, 64, 13, 64, 64,
     +  64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,
     +  64, 90,127,123, 91,108, 80,125, 77, 93, 92, 78,107, 96, 75, 97,
     + 240,241,242,243,244,245,246,247,248,249,122, 94, 76,126,110,111,
     + 124,193,194,195,196,197,198,199,200,201,209,210,211,212,213,214,
     + 215,216,217,226,227,228,229,230,231,232,233,173,224,189, 95,109,
     + 121,129,130,131,132,133,134,135,136,137,145,146,147,148,149,150,
     + 151,152,153,162,163,164,165,166,167,168,169,192, 79,208,161, 64,
     +  64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,
     +  64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,
     +  64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,
     +  64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,
     +  64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,
     +  64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,
     +  64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,
     +  64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64 /
*
      DATA IDBFL /0/
*
* -------------  CODE  ---------------------
*
      JNN = INN
      IF(IDBFL.NE.0) WRITE(6,1001) INN
 1001 FORMAT(' CNV: INN ',Z8)
*
      IF(JNN.NE.0) THEN
        IA1 = ISHFT(JNN,-24)
        IA2 = IAND(IA1,255)
        IA22 = ATOE(IA2)
        IA23 = ISHFT(IA22,24)
        IF(IDBFL.NE.0)  WRITE(6,1002) IA1,IA2,IA22,IA23
 1002   FORMAT(' CNV: IA1 IA2 IA22,IA23 ',4(Z8,2X))
*
        IA3 = ISHFT(JNN,-16)
        IA4 = IAND(IA3,255)
        IA42 = ATOE(IA4)
        IA43 = ISHFT(IA42,16)
        IF(IDBFL.NE.0) WRITE(6,1003) IA3,IA4,IA42,IA43
 1003   FORMAT(' CNV: IA3 IA4 IA42 IA43 ',4(Z8,2X))
*
        IA5 = ISHFT(JNN,-8)
        IA6 = IAND(IA5,255)
        IA62 = ATOE(IA6)
        IA63 = ISHFT(IA62,8)
        IF(IDBFL.NE.0) WRITE(6,1004) IA5,IA6,IA62,IA63
 1004   FORMAT(' CNV: IA5 IA6 IA62 IA63 ',4(Z8,2X))
*
        IA7 = IAND(JNN,255)
        IA8 = ATOE(IA7)
        IF(IDBFL.NE.0) WRITE(6,1005) IA7,IA8
 1005   FORMAT(' CNV: IA7 IA8 ',2(Z8,2X))
*
        IA9 = IOR(IA23,IA43)
        IAA = IOR(IA63,IA8)
        JNN = IOR(IA9,IAA)
        IF(IDBFL.NE.0) WRITE(6,1006) IIA9,IAA,JNN
 1006     FORMAT(' CNV: IA9 IAA JNN ',3(Z8,2X))
        INN = JNN
      ENDIF
*
      RETURN
      END
